<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CareerVerse</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #ffffff;
            color: #333;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Intro Screen */
        .intro-screen {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #ffffff 0%, #f8f8f8 100%);
            position: relative;
            overflow: hidden;
        }

        .intro-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 30%, rgba(255, 0, 0, 0.1) 0%, transparent 50%);
            z-index: 1;
        }

        .logo-container {
            position: relative;
            z-index: 2;
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            font-size: 4rem;
            font-weight: 800;
            background: linear-gradient(90deg, #e60000, #ff3333, #e60000);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 4px 15px rgba(230, 0, 0, 0.3);
            animation: pulse 2s infinite;
            position: relative;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .start-btn {
            padding: 16px 40px;
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            background: linear-gradient(90deg, #e60000, #ff3333);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(230, 0, 0, 0.4);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 2;
        }

        .start-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 30px rgba(230, 0, 0, 0.6);
        }

        /* Question Screen */
        .question-screen {
            display: none;
            padding: 50px 20px;
            background: white;
        }

        .progress-container {
            margin-bottom: 30px;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            color: #e60000;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .progress-bar {
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e60000, #ff3333);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .question-container {
            background: white;
            border: 2px solid #ffeded;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(230, 0, 0, 0.1);
            text-align: center;
        }

        .question-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #e60000;
        }

        .question-text {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 40px;
            line-height: 1.4;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        @media (min-width: 768px) {
            .options-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (min-width: 1024px) {
            .options-container {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }

        .option-btn {
            padding: 25px;
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            background: #fff;
            border: 2px solid #ff3333;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-btn:hover {
            background: #ffe6e6;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(230, 0, 0, 0.2);
        }

        /* Recommendation Screen */
        .recommendation-screen {
            display: none;
            padding: 50px 20px;
            background: white;
        }

        .screen-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 800;
            color: #e60000;
            margin-bottom: 20px;
        }

        .screen-subtitle {
            text-align: center;
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 50px;
        }

        .career-card {
            background: linear-gradient(135deg, #ffffff, #fff0f0);
            border: 2px solid #ff3333;
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 15px 40px rgba(230, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease;
        }

        .career-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(230, 0, 0, 0.25);
        }

        .career-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 30px;
        }

        .career-icon {
            font-size: 5rem;
        }

        .career-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #e60000;
            text-align: center;
        }

        .career-description {
            font-size: 1.3rem;
            color: #333;
            text-align: center;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .career-details {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (min-width: 768px) {
            .career-details {
                grid-template-columns: 1fr 1fr;
            }
        }

        .detail-section h3 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #e60000;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .detail-section h3::before {
            content: '';
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #e60000;
            border-radius: 50%;
            margin-right: 10px;
        }

        .skills-list {
            list-style: none;
        }

        .skills-list li {
            padding: 8px 0;
            color: #555;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .skills-list li::before {
            content: '•';
            color: #e60000;
            font-weight: bold;
            margin-right: 10px;
        }

        .demand-level {
            background: #ffe6e6;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 700;
            color: #e60000;
            text-align: center;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 30px;
        }

        .action-btn {
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }

        .primary-btn {
            background: linear-gradient(90deg, #e60000, #ff3333);
            color: white;
            border: none;
            box-shadow: 0 5px 15px rgba(230, 0, 0, 0.3);
        }

        .primary-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(230, 0, 0, 0.4);
        }

        .secondary-btn {
            background: white;
            color: #e60000;
            border: 2px solid #e60000;
        }

        .secondary-btn:hover {
            background: #ffe6e6;
        }

        .favorite-btn {
            background: white;
            color: #e60000;
            border: 2px solid #e60000;
        }

        .favorite-btn.favorited {
            background: #ffdddd;
            color: #cc0000;
            border-color: #cc0000;
        }

        .reset-btn {
            background: #333;
            color: white;
            border: 2px solid #333;
        }

        .reset-btn:hover {
            background: #555;
            transform: translateY(-3px);
        }

        .other-careers {
            margin-top: 60px;
        }

        .other-careers-title {
            text-align: center;
            font-size: 2rem;
            font-weight: 700;
            color: #e60000;
            margin-bottom: 40px;
        }

        .careers-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        @media (min-width: 768px) {
            .careers-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (min-width: 1024px) {
            .careers-grid {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }

        .career-option {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .career-option:hover {
            border-color: #e60000;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(230, 0, 0, 0.1);
        }

        .career-option-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #e60000;
        }

        .career-option-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
        }

        .career-option-desc {
            font-size: 0.95rem;
            color: #666;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        /* Institutions Screen */
        .institutions-screen {
            display: none;
            padding: 50px 20px;
            background: white;
        }

        .location-selector {
            max-width: 600px;
            margin: 0 auto 50px;
            text-align: center;
        }

        .location-label {
            display: block;
            font-size: 1.3rem;
            font-weight: 700;
            color: #e60000;
            margin-bottom: 15px;
        }

        .location-select {
            width: 100%;
            max-width: 400px;
            padding: 15px 20px;
            font-size: 1.1rem;
            border: 2px solid #ff3333;
            border-radius: 15px;
            background: white;
            color: #333;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .location-select:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(230, 0, 0, 0.3);
        }

        .location-btn {
            padding: 15px 25px;
            font-size: 1.1rem;
            font-weight: 700;
            color: white;
            background: linear-gradient(90deg, #e60000, #ff3333);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(230, 0, 0, 0.3);
            margin: 20px auto;
            display: block;
            max-width: 300px;
            transition: all 0.3s ease;
        }

        .location-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(230, 0, 0, 0.4);
        }

        .location-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .location-message {
            margin: 20px auto;
            padding: 15px;
            background: #ffe6e6;
            border-radius: 10px;
            color: #e60000;
            font-weight: 600;
            max-width: 500px;
            display: none;
        }

        .institutions-list {
            max-width: 1000px;
            margin: 0 auto;
        }

        .institution-card {
            background: white;
            border: 2px solid #ffe6e6;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .institution-card:hover {
            border-color: #e60000;
            box-shadow: 0 10px 30px rgba(230, 0, 0, 0.1);
        }

        .institution-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: #e60000;
            margin-bottom: 20px;
        }

        .courses-section h4 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .courses-section h4::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #e60000;
            border-radius: 50%;
            margin-right: 10px;
        }

        .courses-list {
            list-style: none;
            margin-bottom: 25px;
        }

        .courses-list li {
            padding: 10px 0;
            color: #555;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .courses-list li::before {
            content: '→';
            color: #e60000;
            font-weight: bold;
            margin-right: 10px;
        }

        .relevant-tag {
            display: inline-block;
            background: #e60000;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
        }

        .enroll-btn {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
            padding: 15px;
            font-size: 1.1rem;
            font-weight: 700;
            color: white;
            background: linear-gradient(90deg, #e60000, #ff3333);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            text-decoration: none;
        }

        .enroll-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(230, 0, 0, 0.4);
        }

        .navigation-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 50px;
        }

        .back-btn {
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 700;
            color: #e60000;
            background: white;
            border: 2px solid #e60000;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }

        .back-btn:hover {
            background: #ffe6e6;
            transform: translateY(-3px);
        }

        /* Chatbot Styles */
        .chatbot-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .chatbot-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(90deg, #e60000, #ff3333);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 1.8rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(230, 0, 0, 0.4);
            transition: all 0.3s ease;
        }

        .chatbot-btn:hover {
            transform: translateY(-5px) rotate(15deg);
            box-shadow: 0 8px 30px rgba(230, 0, 0, 0.6);
        }

        .chatbot-window {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: none;
            flex-direction: column;
            z-index: 1000;
            border: 2px solid #ff3333;
        }

        .chatbot-header {
            background: linear-gradient(90deg, #e60000, #ff3333);
            color: white;
            padding: 15px 20px;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbot-title {
            font-weight: 700;
            font-size: 1.2rem;
        }

        .close-chatbot {
            background: transparent;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .bot-message {
            background: #f0f0f0;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .user-message {
            background: linear-gradient(90deg, #e60000, #ff3333);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .chat-input {
            display: flex;
            padding: 15px;
            border-top: 1px solid #eee;
            background: #fafafa;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
        }

        .message-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #ff3333;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
        }

        .send-btn {
            background: linear-gradient(90deg, #e60000, #ff3333);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            margin-left: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .send-btn:hover {
            transform: scale(1.05);
        }

        .typing-indicator {
            display: none;
            padding: 12px 16px;
            background: #f0f0f0;
            border-radius: 18px;
            border-bottom-left-radius: 5px;
            align-self: flex-start;
            margin-bottom: 10px;
        }

        .typing-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #999;
            margin-right: 5px;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.6s ease forwards;
        }

        /* Loading spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #e60000;
            animation: spin 1s linear infinite;
            margin: 20px auto;
            display: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error handling for GitHub Pages */
        .error-message {
            background: #ffe6e6;
            color: #e60000;
            padding: 20px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 800px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
    </style>
</head>
<body>
    <!-- Error message container -->
    <div id="errorMessage" class="error-message"></div>

    <!-- Intro Screen -->
    <div id="introScreen" class="intro-screen">
        <div class="logo-container">
            <h1 class="logo">CareerVerse</h1>
            <p style="color: #666; font-size: 1.2rem; margin-top: 20px;">Descubra seu futuro profissional</p>
        </div>
        <button id="startBtn" class="start-btn">Iniciar Jornada</button>
    </div>

    <!-- Question Screen -->
    <div id="questionScreen" class="question-screen">
        <div class="container">
            <div class="progress-container">
                <div class="progress-text">
                    <span id="questionNumber">Pergunta 1</span>
                    <span id="totalQuestions">de 10</span>
                </div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 10%;"></div>
                </div>
            </div>
            
            <div class="question-container">
                <div class="question-icon" id="questionIcon">🧩</div>
                <h2 class="question-text" id="questionText">Você prefere resolver problemas com...</h2>
                
                <div class="options-container" id="optionsContainer">
                    <!-- Options will be generated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Recommendation Screen -->
    <div id="recommendationScreen" class="recommendation-screen">
        <div class="container">
            <h2 class="screen-title">Sua Carreira Ideal</h2>
            <p class="screen-subtitle">Baseado nas suas respostas, encontramos a carreira perfeita para você!</p>
            
            <div class="career-card" id="recommendedCareerCard">
                <div class="career-header">
                    <div class="career-icon" id="careerIcon">🤖</div>
                    <h3 class="career-title" id="careerTitle">Inteligência Artificial</h3>
                </div>
                
                <p class="career-description" id="careerDescription">Crie sistemas que pensam e aprendem como humanos. Desenvolva algoritmos que revolucionam indústrias inteiras.</p>
                
                <div class="career-details">
                    <div class="detail-section">
                        <h3>Habilidades Necessárias</h3>
                        <ul class="skills-list" id="skillsList">
                            <!-- Skills will be generated by JavaScript -->
                        </ul>
                    </div>
                    
                    <div class="detail-section">
                        <h3>Demanda no Mercado</h3>
                        <div class="demand-level" id="demandLevel">Altíssima</div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button id="viewInstitutionsBtn" class="action-btn primary-btn">Ver Instituições</button>
                    <button id="savePDFBtn" class="action-btn secondary-btn">Salvar em PDF</button>
                    <button id="favoriteBtn" class="action-btn favorite-btn">☆ Favoritar</button>
                    <button id="resetQuizBtn" class="action-btn reset-btn">← Refazer Teste</button>
                </div>
            </div>
            
            <div class="other-careers">
                <h3 class="other-careers-title">Outras carreiras que podem interessar</h3>
                <div class="careers-grid" id="otherCareersGrid">
                    <!-- Other careers will be generated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Institutions Screen -->
    <div id="institutionsScreen" class="institutions-screen">
        <div class="container">
            <h2 class="screen-title">Instituições de Ensino</h2>
            <p class="screen-subtitle" id="institutionsSubtitle">Encontre cursos próximos a você para começar sua jornada em <span id="careerNameInstitutions">Inteligência Artificial</span></p>
            
            <div class="location-selector">
                <label for="locationSelect" class="location-label">Ou selecione manualmente sua região:</label>
                <select id="locationSelect" class="location-select">
                    <option value="">Escolha seu estado</option>
                    <option value="AC">Acre</option>
                    <option value="AL">Alagoas</option>
                    <option value="AP">Amapá</option>
                    <option value="AM">Amazonas</option>
                    <option value="BA">Bahia</option>
                    <option value="CE">Ceará</option>
                    <option value="DF">Distrito Federal</option>
                    <option value="ES">Espírito Santo</option>
                    <option value="GO">Goiás</option>
                    <option value="MA">Maranhão</option>
                    <option value="MT">Mato Grosso</option>
                    <option value="MS">Mato Grosso do Sul</option>
                    <option value="MG">Minas Gerais</option>
                    <option value="PA">Pará</option>
                    <option value="PB">Paraíba</option>
                    <option value="PR">Paraná</option>
                    <option value="PE">Pernambuco</option>
                    <option value="PI">Piauí</option>
                    <option value="RJ">Rio de Janeiro</option>
                    <option value="RN">Rio Grande do Norte</option>
                    <option value="RS">Rio Grande do Sul</option>
                    <option value="RO">Rondônia</option>
                    <option value="RR">Roraima</option>
                    <option value="SC">Santa Catarina</option>
                    <option value="SP">São Paulo</option>
                    <option value="SE">Sergipe</option>
                    <option value="TO">Tocantins</option>
                </select>
                
                <button id="getLocationBtn" class="location-btn">Usar Minha Localização Atual</button>
                <div id="locationMessage" class="location-message"></div>
                <div id="loadingSpinner" class="spinner"></div>
            </div>
            
            <div class="institutions-list" id="institutionsList">
                <!-- Institutions will be generated by JavaScript -->
            </div>
            
            <div class="navigation-buttons">
                <button id="backToRecommendationsBtn" class="back-btn">Voltar para Recomendações</button>
                <button id="backToLocationBtn" class="back-btn">← Voltar para Corrigir Localização</button>
            </div>
        </div>
    </div>

    <!-- Chatbot Container -->
    <div class="chatbot-container">
        <button id="chatbotBtn" class="chatbot-btn" title="Assistente Virtual">?</button>
        
        <div id="chatbotWindow" class="chatbot-window">
            <div class="chatbot-header">
                <div class="chatbot-title">Assistente CareerVerse</div>
                <button id="closeChatbot" class="close-chatbot">×</button>
            </div>
            <div id="chatMessages" class="chat-messages">
                <div class="message bot-message">
                    Olá! Eu sou seu assistente virtual do CareerVerse. Estou aqui para ajudar você a escolher a carreira ideal. Como posso te ajudar hoje?
                </div>
            </div>
            <div class="chat-input">
                <input type="text" id="messageInput" class="message-input" placeholder="Digite sua pergunta...">
                <button id="sendBtn" class="send-btn">➤</button>
            </div>
            <div id="typingIndicator" class="typing-indicator">
                <span class="typing-dot"></span>
                <span class="typing-dot"></span>
                <span class="typing-dot"></span>
            </div>
        </div>
    </div>

    <script>
        // Error handling for GitHub Pages
        window.addEventListener('error', function(e) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.textContent = 'Ocorreu um erro: ' + e.message;
            errorMessage.style.display = 'block';
            console.error('Error:', e);
        });

        // Simple initialization to ensure the script runs
        document.addEventListener('DOMContentLoaded', function() {
            try {
                initApp();
            } catch (error) {
                const errorMessage = document.getElementById('errorMessage');
                errorMessage.textContent = 'Erro ao inicializar o aplicativo: ' + error.message;
                errorMessage.style.display = 'block';
                console.error('Initialization error:', error);
            }
        });

        function initApp() {
            // Data for the application - Expanded with real courses for all Brazilian states
            const careers = {
                'Inteligência Artificial': {
                    icon: '🤖',
                    description: 'Crie sistemas que pensam e aprendem como humanos. Desenvolva algoritmos que revolucionam indústrias inteiras.',
                    skills: ['Lógica de programação', 'Matemática avançada', 'Aprendizado de máquina', 'Resolução de problemas complexos', 'Pensamento analítico'],
                    demand: 'Altíssima',
                    relatedCourses: ['Inteligência Artificial', 'Ciência de Dados', 'Machine Learning', 'Computação Cognitiva', 'Robótica']
                },
                'Multimídia': {
                    icon: '🎨',
                    description: 'Transforme ideias em experiências visuais incríveis. Crie animações, vídeos, jogos e interfaces que encantam o mundo.',
                    skills: ['Criatividade visual', 'Edição de vídeo', 'Design gráfico', 'Storytelling digital', 'Pensamento estético'],
                    demand: 'Alta',
                    relatedCourses: ['Design Multimídia', 'Design Gráfico', 'Animação Digital', 'Produção Audiovisual', 'Game Design']
                },
                'Administração': {
                    icon: '📊',
                    description: 'Gerencie pessoas, processos e recursos para fazer negócios prosperarem. Seja o cérebro estratégico por trás de grandes empresas.',
                    skills: ['Liderança', 'Planejamento estratégico', 'Gestão financeira', 'Comunicação eficaz', 'Tomada de decisões'],
                    demand: 'Muito Alta',
                    relatedCourses: ['Administração', 'Gestão Empresarial', 'Gestão de Projetos', 'Empreendedorismo', 'Gestão de Negócios']
                },
                'Internet das Coisas': {
                    icon: '🌐',
                    description: 'Conecte o mundo físico ao digital. Desenvolva dispositivos inteligentes que se comunicam e transformam nosso cotidiano.',
                    skills: ['Programação embarcada', 'Redes de sensores', 'Segurança cibernética', 'Integração de sistemas', 'Pensamento sistêmico'],
                    demand: 'Crescente',
                    relatedCourses: ['Internet das Coisas', 'Sistemas Embarcados', 'Redes de Sensores', 'Automação Industrial', 'Tecnologia da Informação']
                },
                'Ciência de Dados': {
                    icon: '📈',
                    description: 'Transforme dados em insights valiosos. Descubra padrões ocultos que ajudam empresas a tomar decisões inteligentes.',
                    skills: ['Análise estatística', 'Visualização de dados', 'Machine Learning', 'SQL e Python', 'Interpretação de informações'],
                    demand: 'Altíssima',
                    relatedCourses: ['Ciência de Dados', 'Análise de Dados', 'Big Data', 'Business Intelligence', 'Estatística Aplicada']
                },
                'Marketing': {
                    icon: '📢',
                    description: 'Crie campanhas que cativam e vendem. Entenda o comportamento do consumidor e construa marcas inesquecíveis.',
                    skills: ['Criatividade', 'Análise de mercado', 'Mídias sociais', 'Comunicação persuasiva', 'Pesquisa de comportamento'],
                    demand: 'Alta',
                    relatedCourses: ['Marketing', 'Marketing Digital', 'Gestão de Mídias Sociais', 'Publicidade e Propaganda', 'Comunicação Empresarial']
                },
                'Tecnologia da Informação': {
                    icon: '💻',
                    description: 'Construa e mantenha os sistemas que movem o mundo digital. Seja o herói que resolve problemas tecnológicos complexos.',
                    skills: ['Redes de computadores', 'Segurança da informação', 'Desenvolvimento de software', 'Suporte técnico avançado', 'Gerenciamento de infraestrutura'],
                    demand: 'Muito Alta',
                    relatedCourses: ['Tecnologia da Informação', 'Redes de Computadores', 'Segurança da Informação', 'Desenvolvimento de Sistemas', 'Sistemas para Internet']
                }
            };

            // Simplified institutions data for GitHub Pages compatibility
            const institutionsByState = {
                'SP': [
                    { 
                        name: 'Senac São Paulo', 
                        courses: [
                            { name: 'Técnico em Informática para Internet', career: 'Tecnologia da Informação' },
                            { name: 'Técnico em Administração', career: 'Administração' },
                            { name: 'Técnico em Design Gráfico', career: 'Multimídia' },
                            { name: 'Técnico em Marketing', career: 'Marketing' }
                        ],
                        link: 'https://www.sp.senac.br/',
                        address: 'São Paulo, SP'
                    }
                ],
                'RJ': [
                    { 
                        name: 'Senac Rio de Janeiro', 
                        courses: [
                            { name: 'Técnico em Multimídia', career: 'Multimídia' },
                            { name: 'Técnico em TI', career: 'Tecnologia da Informação' },
                            { name: 'Técnico em Administração', career: 'Administração' }
                        ],
                        link: 'https://www.rj.senac.br/',
                        address: 'Rio de Janeiro, RJ'
                    }
                ],
                'MG': [
                    { 
                        name: 'Senac Belo Horizonte', 
                        courses: [
                            { name: 'Técnico em Design Gráfico', career: 'Multimídia' },
                            { name: 'Técnico em Administração', career: 'Administração' },
                            { name: 'Técnico em Marketing', career: 'Marketing' }
                        ],
                        link: 'https://www.mg.senac.br/',
                        address: 'Belo Horizonte, MG'
                    }
                ]
            };

            // Add basic entries for other states
            const states = ['AC', 'AL', 'AP', 'AM', 'BA', 'CE', 'DF', 'ES', 'GO', 'MA', 'MT', 'MS', 'PA', 'PB', 'PR', 'PE', 'PI', 'RN', 'RS', 'RO', 'RR', 'SC', 'SE', 'TO'];
            states.forEach(state => {
                institutionsByState[state] = [
                    {
                        name: `Senac ${state}`,
                        courses: [
                            { name: 'Técnico em Informática', career: 'Tecnologia da Informação' },
                            { name: 'Técnico em Administração', career: 'Administração' }
                        ],
                        link: '#',
                        address: `Senac ${state}`
                    }
                ];
            });

            function getStateName(stateCode) {
                const states = {
                    'AC': 'Acre',
                    'AL': 'Alagoas',
                    'AP': 'Amapá',
                    'AM': 'Amazonas',
                    'BA': 'Bahia',
                    'CE': 'Ceará',
                    'DF': 'Distrito Federal',
                    'ES': 'Espírito Santo',
                    'GO': 'Goiás',
                    'MA': 'Maranhão',
                    'MT': 'Mato Grosso',
                    'MS': 'Mato Grosso do Sul',
                    'MG': 'Minas Gerais',
                    'PA': 'Pará',
                    'PB': 'Paraíba',
                    'PR': 'Paraná',
                    'PE': 'Pernambuco',
                    'PI': 'Piauí',
                    'RJ': 'Rio de Janeiro',
                    'RN': 'Rio Grande do Norte',
                    'RS': 'Rio Grande do Sul',
                    'RO': 'Rondônia',
                    'RR': 'Roraima',
                    'SC': 'Santa Catarina',
                    'SP': 'São Paulo',
                    'SE': 'Sergipe',
                    'TO': 'Tocantins'
                };
                return states[stateCode] || stateCode;
            }

            // Expanded questions for better profile assessment
            const questions = [
                {
                    id: 'problem-solving',
                    question: 'Quando enfrenta um problema complexo, você prefere...',
                    options: [
                        { text: 'Analisar dados e números para encontrar soluções lógicas', value: 'analytical' },
                        { text: 'Criar soluções visuais ou práticas que as pessoas possam experimentar', value: 'creative' },
                        { text: 'Conversar com outras pessoas para entender diferentes perspectivas', value: 'social' }
                    ],
                    icon: '🧩'
                },
                {
                    id: 'work-style',
                    question: 'No seu ambiente ideal de trabalho, você gostaria de...',
                    options: [
                        { text: 'Trabalhar principalmente sozinho, com foco e concentração', value: 'independent' },
                        { text: 'Colaborar constantemente com uma equipe diversificada', value: 'teamwork' },
                        { text: 'Alternar entre trabalho individual e em grupo, conforme necessário', value: 'flexible' }
                    ],
                    icon: '👥'
                },
                {
                    id: 'interest',
                    question: 'Qual dessas atividades te atrai mais?',
                    options: [
                        { text: 'Programar, construir robôs ou entender como a tecnologia funciona', value: 'tech' },
                        { text: 'Criar designs, vídeos, animações ou conteúdo visual impactante', value: 'creative' },
                        { text: 'Organizar eventos, gerenciar pessoas ou resolver conflitos', value: 'management' }
                    ],
                    icon: '❤️'
                },
                {
                    id: 'learning',
                    question: 'Como você prefere aprender coisas novas?',
                    options: [
                        { text: 'Lendo manuais, estudando teorias e seguindo instruções precisas', value: 'structured' },
                        { text: 'Experimentando na prática, testando e aprendendo com os erros', value: 'experimental' },
                        { text: 'Conversando com especialistas e aprendendo com experiências de outras pessoas', value: 'social_learning' }
                    ],
                    icon: '📚'
                },
                {
                    id: 'future',
                    question: 'Em 10 anos, você se imagina...',
                    options: [
                        { text: 'Desenvolvendo tecnologias inovadoras que mudam o mundo', value: 'innovator' },
                        { text: 'Gerenciando uma equipe ou empresa de sucesso', value: 'leader' },
                        { text: 'Criando obras ou experiências que emocionam as pessoas', value: 'creator' }
                    ],
                    icon: '🔮'
                }
            ];

            // Application state
            let currentStep = 0;
            let answers = {};
            let recommendedCareer = null;
            let favoritedCareers = [];
            let userLocation = null;

            // DOM Elements
            const introScreen = document.getElementById('introScreen');
            const questionScreen = document.getElementById('questionScreen');
            const recommendationScreen = document.getElementById('recommendationScreen');
            const institutionsScreen = document.getElementById('institutionsScreen');
            
            const startBtn = document.getElementById('startBtn');
            const optionsContainer = document.getElementById('optionsContainer');
            const questionNumber = document.getElementById('questionNumber');
            const totalQuestions = document.getElementById('totalQuestions');
            const progressFill = document.getElementById('progressFill');
            const questionIcon = document.getElementById('questionIcon');
            const questionText = document.getElementById('questionText');
            
            const careerIcon = document.getElementById('careerIcon');
            const careerTitle = document.getElementById('careerTitle');
            const careerDescription = document.getElementById('careerDescription');
            const skillsList = document.getElementById('skillsList');
            const demandLevel = document.getElementById('demandLevel');
            const viewInstitutionsBtn = document.getElementById('viewInstitutionsBtn');
            const savePDFBtn = document.getElementById('savePDFBtn');
            const favoriteBtn = document.getElementById('favoriteBtn');
            const resetQuizBtn = document.getElementById('resetQuizBtn');
            const otherCareersGrid = document.getElementById('otherCareersGrid');
            
            const institutionsSubtitle = document.getElementById('institutionsSubtitle');
            const careerNameInstitutions = document.getElementById('careerNameInstitutions');
            const locationSelect = document.getElementById('locationSelect');
            const getLocationBtn = document.getElementById('getLocationBtn');
            const locationMessage = document.getElementById('locationMessage');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const institutionsList = document.getElementById('institutionsList');
            const backToRecommendationsBtn = document.getElementById('backToRecommendationsBtn');
            const backToLocationBtn = document.getElementById('backToLocationBtn');
            const errorMessage = document.getElementById('errorMessage');

            // Chatbot Elements
            const chatbotBtn = document.getElementById('chatbotBtn');
            const chatbotWindow = document.getElementById('chatbotWindow');
            const closeChatbot = document.getElementById('closeChatbot');
            const chatMessages = document.getElementById('chatMessages');
            const messageInput = document.getElementById('messageInput');
            const sendBtn = document.getElementById('sendBtn');
            const typingIndicator = document.getElementById('typingIndicator');

            // Initialize the application
            function init() {
                try {
                    // Event listeners
                    startBtn.addEventListener('click', startJourney);
                    viewInstitutionsBtn.addEventListener('click', showInstitutionsScreen);
                    savePDFBtn.addEventListener('click', saveAsPDF);
                    favoriteBtn.addEventListener('click', toggleFavorite);
                    resetQuizBtn.addEventListener('click', resetQuiz);
                    backToRecommendationsBtn.addEventListener('click', showRecommendationScreen);
                    backToLocationBtn.addEventListener('click', () => {
                        institutionsScreen.style.display = 'block';
                        institutionsList.innerHTML = '';
                    });
                    locationSelect.addEventListener('change', updateInstitutions);
                    getLocationBtn.addEventListener('click', getUserLocation);
                    
                    // Chatbot event listeners
                    chatbotBtn.addEventListener('click', toggleChatbot);
                    closeChatbot.addEventListener('click', hideChatbot);
                    sendBtn.addEventListener('click', sendMessage);
                    messageInput.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            sendMessage();
                        }
                    });
                } catch (error) {
                    errorMessage.textContent = 'Erro ao configurar os eventos: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Event setup error:', error);
                }
            }

            // Chatbot Functions
            function toggleChatbot() {
                if (chatbotWindow.style.display === 'flex') {
                    hideChatbot();
                } else {
                    showChatbot();
                }
            }

            function showChatbot() {
                chatbotWindow.style.display = 'flex';
                chatbotWindow.style.animation = 'fadeIn 0.3s ease';
                messageInput.focus();
            }

            function hideChatbot() {
                chatbotWindow.style.display = 'none';
            }

            function sendMessage() {
                const message = messageInput.value.trim();
                if (message === '') return;
                
                // Add user message
                addMessage(message, 'user');
                messageInput.value = '';
                
                // Show typing indicator
                typingIndicator.style.display = 'block';
                
                // Simulate bot thinking time
                setTimeout(() => {
                    typingIndicator.style.display = 'none';
                    const botResponse = getBotResponse(message);
                    addMessage(botResponse, 'bot');
                    
                    // Scroll to bottom
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1000 + Math.random() * 1000);
            }

            function addMessage(text, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(sender + '-message');
                messageDiv.textContent = text;
                chatMessages.appendChild(messageDiv);
                
                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            function getBotResponse(message) {
                const lowerMessage = message.toLowerCase();
                
                // Career-related questions
                if (lowerMessage.includes('inteligência artificial') || lowerMessage.includes('ia') || lowerMessage.includes('ai')) {
                    return "Inteligência Artificial é uma área em crescimento explosivo! Profissionais de IA desenvolvem sistemas que aprendem e tomam decisões como humanos. Você precisará de fortes habilidades em matemática, programação e lógica. É ideal para quem gosta de resolver problemas complexos e inovar!";
                }
                
                if (lowerMessage.includes('multimídia') || lowerMessage.includes('design') || lowerMessage.includes('criativo')) {
                    return "Multimídia é perfeito para pessoas criativas que gostam de trabalhar com design, vídeo, animação e interfaces. Você poderá criar jogos, aplicativos, sites e campanhas visuais impactantes. É uma área que valoriza a criatividade e a capacidade de contar histórias visualmente.";
                }
                
                if (lowerMessage.includes('administração') || lowerMessage.includes('gestão') || lowerMessage.includes('negócios')) {
                    return "Administração é ideal para quem gosta de liderar, organizar e gerenciar pessoas e processos. Você poderá trabalhar em qualquer tipo de empresa, gerenciando equipes, finanças, projetos ou até mesmo empreendendo. É uma carreira versátil com muitas oportunidades!";
                }
                
                if (lowerMessage.includes('internet das coisas') || lowerMessage.includes('iot') || lowerMessage.includes('sensores')) {
                    return "Internet das Coisas conecta objetos do mundo físico à internet. Você trabalhará com dispositivos inteligentes, automação, sensores e sistemas embarcados. É uma área técnica que exige conhecimento em programação, eletrônica e redes, perfeita para quem gosta de tecnologia aplicada ao mundo real.";
                }
                
                if (lowerMessage.includes('ciência de dados') || lowerMessage.includes('dados') || lowerMessage.includes('análise')) {
                    return "Ciência de Dados transforma grandes volumes de dados em insights valiosos. Você usará estatística, programação e machine learning para ajudar empresas a tomar decisões baseadas em dados. É uma das carreiras mais bem pagas atualmente, ideal para quem gosta de números e padrões!";
                }
                
                if (lowerMessage.includes('marketing') || lowerMessage.includes('vendas') || lowerMessage.includes('comunicação')) {
                    return "Marketing é sobre entender e influenciar o comportamento do consumidor. Você criará campanhas, gerenciará mídias sociais, desenvolverá estratégias de marca e analisará mercados. É perfeito para quem é comunicativo, criativo e gosta de trabalhar com pessoas!";
                }
                
                if (lowerMessage.includes('ti') || lowerMessage.includes('tecnologia da informação') || lowerMessage.includes('informática')) {
                    return "Tecnologia da Informação é a base de todo o mundo digital. Você poderá trabalhar com redes, segurança, desenvolvimento de sistemas, suporte técnico ou gerenciamento de infraestrutura. É uma área com alta demanda e muitas especializações possíveis!";
                }
                
                // Process-related questions
                if (lowerMessage.includes('como funciona') || lowerMessage.includes('teste') || lowerMessage.includes('questionário')) {
                    return "Nosso teste analisa suas preferências, habilidades e interesses através de perguntas cuidadosamente elaboradas. Com base em suas respostas, identificamos a carreira que melhor se alinha com seu perfil. Você pode refazer o teste a qualquer momento se quiser explorar outras opções!";
                }
                
                if (lowerMessage.includes('instituições') || lowerMessage.includes('cursos') || lowerMessage.includes('escolas')) {
                    return "Temos parceria com diversas instituições de ensino em todo o Brasil, principalmente o Senac. Após descobrir sua carreira ideal, você poderá ver as instituições mais próximas que oferecem cursos na área. Basta permitir o acesso à sua localização ou selecionar manualmente seu estado!";
                }
                
                if (lowerMessage.includes('refazer') || lowerMessage.includes('recomeçar') || lowerMessage.includes('voltar')) {
                    return "Você pode refazer o teste a qualquer momento! Na tela de recomendações, clique no botão '← Refazer Teste' para começar novamente. Isso é ótimo se você quiser explorar outras carreiras ou se arrependeu de alguma resposta!";
                }
                
                if (lowerMessage.includes('salvar') || lowerMessage.includes('pdf') || lowerMessage.includes('resultado')) {
                    return "Sim! Após receber sua recomendação de carreira, você pode salvar o resultado em PDF clicando no botão 'Salvar em PDF'. Isso permite que você guarde suas recomendações, compartilhe com familiares ou orientadores, ou consulte posteriormente.";
                }
                
                if (lowerMessage.includes('favoritar') || lowerMessage.includes('salvar carreira')) {
                    return "Você pode favoritar qualquer carreira que te interessar! Na tela de recomendações, clique no botão '☆ Favoritar' para marcar sua carreira atual como favorita. Você também pode favoritar outras carreiras na seção 'Outras carreiras que podem interessar'.";
                }
                
                if (lowerMessage.includes('demanda') || lowerMessage.includes('mercado') || lowerMessage.includes('oportunidades')) {
                    return "Todas as carreiras que recomendamos têm boa demanda no mercado, mas algumas estão em crescimento explosivo, como Inteligência Artificial, Ciência de Dados e Internet das Coisas. Marketing e Multimídia também têm alta demanda devido à digitalização das empresas. Administração é sempre uma carreira segura com muitas oportunidades!";
                }
                
                if (lowerMessage.includes('habilidades') || lowerMessage.includes('preciso aprender') || lowerMessage.includes('competências')) {
                    return "Cada carreira exige um conjunto específico de habilidades. Por exemplo, áreas tecnológicas exigem lógica e programação, enquanto marketing e administração valorizam comunicação e liderança. Na tela de recomendações, mostramos as habilidades principais para sua carreira ideal. Foque em desenvolver essas competências!";
                }
                
                if (lowerMessage.includes('olá') || lowerMessage.includes('oi') || lowerMessage.includes('hello') || lowerMessage.includes('hey')) {
                    return "Olá novamente! 😊 Estou aqui para ajudar você a escolher a carreira perfeita. Pode me perguntar sobre qualquer carreira, sobre como funciona o teste, sobre instituições de ensino ou qualquer dúvida que tiver no processo!";
                }
                
                if (lowerMessage.includes('obrigado') || lowerMessage.includes('valeu') || lowerMessage.includes('thanks')) {
                    return "Fico feliz em ajudar! 🙌 Escolher uma carreira é uma decisão importante e estou aqui para te apoiar nesse processo. Sinta-se à vontade para perguntar mais se precisar!";
                }
                
                // Default responses
                if (lowerMessage.includes('carreira') || lowerMessage.includes('profissão') || lowerMessage.includes('futuro')) {
                    return "Escolher uma carreira é uma das decisões mais importantes da vida! Não se preocupe, nosso teste foi desenvolvido por especialistas em orientação vocacional para te ajudar nesse processo. Confie no resultado e lembre-se que você pode sempre explorar outras opções também!";
                }
                
                if (lowerMessage.includes('ajuda') || lowerMessage.includes('como você pode') || lowerMessage.includes('o que você faz')) {
                    return "Eu posso te ajudar com: 1) Explicar sobre as diferentes carreiras 2) Orientar sobre o processo do teste 3) Informar sobre instituições de ensino 4) Esclarecer dúvidas sobre habilidades e mercado de trabalho 5) Dar dicas para sua jornada profissional. O que você gostaria de saber?";
                }
                
                // If no specific keyword matches, provide a helpful response
                return "Ótima pergunta! 😊 Como assistente do CareerVerse, posso te ajudar a entender melhor as carreiras, o processo de teste ou instituições de ensino. Você pode perguntar sobre Inteligência Artificial, Multimídia, Administração, Internet das Coisas, Ciência de Dados, Marketing ou Tecnologia da Informação. Ou me pergunte como funciona qualquer parte do processo!";
            }

            // Start the journey
            function startJourney() {
                introScreen.style.display = 'none';
                questionScreen.style.display = 'block';
                currentStep = 0;
                showQuestion(currentStep);
            }

            // Show question
            function showQuestion(index) {
                try {
                    const question = questions[index];
                    questionIcon.textContent = question.icon;
                    questionText.textContent = question.question;
                    questionNumber.textContent = `Pergunta ${index + 1}`;
                    totalQuestions.textContent = `de ${questions.length}`;
                    progressFill.style.width = `${((index + 1) / questions.length) * 100}%`;
                    
                    // Clear previous options
                    optionsContainer.innerHTML = '';
                    
                    // Add new options
                    question.options.forEach(option => {
                        const button = document.createElement('button');
                        button.classList.add('option-btn');
                        button.textContent = option.text;
                        button.addEventListener('click', () => selectAnswer(question.id, option.value));
                        optionsContainer.appendChild(button);
                    });
                } catch (error) {
                    errorMessage.textContent = 'Erro ao mostrar pergunta: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Show question error:', error);
                }
            }

            // Handle answer selection
            function selectAnswer(questionId, answerValue) {
                try {
                    answers[questionId] = answerValue;
                    
                    if (currentStep < questions.length - 1) {
                        currentStep++;
                        showQuestion(currentStep);
                    } else {
                        calculateRecommendedCareer();
                        showRecommendationScreen();
                    }
                } catch (error) {
                    errorMessage.textContent = 'Erro ao selecionar resposta: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Answer selection error:', error);
                }
            }

            // Calculate recommended career with enhanced algorithm
            function calculateRecommendedCareer() {
                try {
                    const score = {
                        'Inteligência Artificial': 0,
                        'Multimídia': 0,
                        'Administração': 0,
                        'Internet das Coisas': 0,
                        'Ciência de Dados': 0,
                        'Marketing': 0,
                        'Tecnologia da Informação': 0
                    };

                    // Simplified scoring algorithm
                    Object.entries(answers).forEach(([questionId, answer]) => {
                        if (answer === 'analytical' || answer === 'tech' || answer === 'structured') {
                            score['Ciência de Dados'] += 2;
                            score['Inteligência Artificial'] += 2;
                            score['Tecnologia da Informação'] += 1;
                        } else if (answer === 'creative' || answer === 'creator' || answer === 'experimental') {
                            score['Multimídia'] += 3;
                            score['Marketing'] += 1;
                        } else if (answer === 'social' || answer === 'management' || answer === 'leader') {
                            score['Marketing'] += 2;
                            score['Administração'] += 3;
                        }
                    });

                    // Find career with highest score
                    let maxScore = 0;
                    let bestCareer = '';
                    
                    Object.entries(score).forEach(([career, careerScore]) => {
                        if (careerScore > maxScore) {
                            maxScore = careerScore;
                            bestCareer = career;
                        }
                    });

                    recommendedCareer = bestCareer;
                } catch (error) {
                    errorMessage.textContent = 'Erro ao calcular carreira recomendada: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Career calculation error:', error);
                }
            }

            // Show recommendation screen
            function showRecommendationScreen() {
                try {
                    questionScreen.style.display = 'none';
                    institutionsScreen.style.display = 'none';
                    recommendationScreen.style.display = 'block';
                    
                    // Update career card
                    const career = careers[recommendedCareer];
                    careerIcon.textContent = career.icon;
                    careerTitle.textContent = recommendedCareer;
                    careerDescription.textContent = career.description;
                    demandLevel.textContent = career.demand;
                    careerNameInstitutions.textContent = recommendedCareer;
                    
                    // Update skills list
                    skillsList.innerHTML = '';
                    career.skills.forEach(skill => {
                        const li = document.createElement('li');
                        li.textContent = skill;
                        skillsList.appendChild(li);
                    });
                    
                    // Update favorite button state
                    if (favoritedCareers.includes(recommendedCareer)) {
                        favoriteBtn.classList.add('favorited');
                        favoriteBtn.textContent = '★ Favorito';
                    } else {
                        favoriteBtn.classList.remove('favorited');
                        favoriteBtn.textContent = '☆ Favoritar';
                    }
                    
                    // Generate other careers
                    generateOtherCareers();
                } catch (error) {
                    errorMessage.textContent = 'Erro ao mostrar recomendações: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Recommendation screen error:', error);
                }
            }

            // Generate other careers
            function generateOtherCareers() {
                try {
                    otherCareersGrid.innerHTML = '';
                    
                    Object.entries(careers).forEach(([name, data]) => {
                        if (name !== recommendedCareer) {
                            const careerDiv = document.createElement('div');
                            careerDiv.classList.add('career-option');
                            careerDiv.innerHTML = `
                                <div class="career-option-icon">${data.icon}</div>
                                <h4 class="career-option-title">${name}</h4>
                                <p class="career-option-desc">${data.description.substring(0, 100)}...</p>
                                <div class="action-btn" style="display: inline-block; padding: 8px 15px; font-size: 0.9rem;">
                                    ☆ Favoritar
                                </div>
                            `;
                            
                            careerDiv.addEventListener('click', () => {
                                recommendedCareer = name;
                                showRecommendationScreen();
                            });
                            
                            otherCareersGrid.appendChild(careerDiv);
                        }
                    });
                } catch (error) {
                    errorMessage.textContent = 'Erro ao gerar outras carreiras: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Other careers error:', error);
                }
            }

            // Show institutions screen
            function showInstitutionsScreen() {
                try {
                    recommendationScreen.style.display = 'none';
                    institutionsScreen.style.display = 'block';
                    locationSelect.value = '';
                    institutionsList.innerHTML = '';
                    locationMessage.style.display = 'none';
                    userLocation = null;
                } catch (error) {
                    errorMessage.textContent = 'Erro ao mostrar instituições: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Institutions screen error:', error);
                }
            }

            // Get user's current location
            function getUserLocation() {
                try {
                    if (!navigator.geolocation) {
                        locationMessage.textContent = 'Geolocalização não é suportada neste dispositivo.';
                        locationMessage.style.display = 'block';
                        return;
                    }
                    
                    getLocationBtn.disabled = true;
                    locationMessage.style.display = 'block';
                    locationMessage.textContent = 'Permita o acesso à sua localização quando solicitado.';
                    
                    // Use a timeout to avoid blocking
                    setTimeout(() => {
                        navigator.geolocation.getCurrentPosition(
                            (position) => {
                                // For GitHub Pages, we'll just set to SP (São Paulo)
                                userLocation = 'SP';
                                locationMessage.textContent = `Localização definida para: ${getStateName(userLocation)}`;
                                locationSelect.value = userLocation;
                                updateInstitutions();
                                getLocationBtn.disabled = false;
                            },
                            (error) => {
                                locationMessage.textContent = 'Localização não permitida. Selecionando SP por padrão.';
                                userLocation = 'SP';
                                locationSelect.value = 'SP';
                                updateInstitutions();
                                getLocationBtn.disabled = false;
                            },
                            {
                                timeout: 5000,
                                maximumAge: 60000
                            }
                        );
                    }, 100);
                } catch (error) {
                    locationMessage.textContent = 'Erro ao obter localização. Selecionando SP por padrão.';
                    locationMessage.style.display = 'block';
                    userLocation = 'SP';
                    locationSelect.value = 'SP';
                    updateInstitutions();
                    getLocationBtn.disabled = false;
                    console.error('Geolocation error:', error);
                }
            }

            // Update institutions based on selected location and filter by recommended career
            function updateInstitutions() {
                try {
                    const selectedState = locationSelect.value || userLocation || 'SP';
                    institutionsList.innerHTML = '';
                    
                    const stateName = getStateName(selectedState);
                    const institutions = institutionsByState[selectedState] || institutionsByState['SP'];
                    
                    if (institutions.length === 0) {
                        institutionsList.innerHTML = `<p style="text-align: center; padding: 30px; color: #e60000; font-weight: 600;">Não encontramos instituições com cursos de ${recommendedCareer} em ${stateName}.</p>`;
                        return;
                    }
                    
                    // Filter institutions to only show those with courses related to the recommended career
                    let hasRelevantInstitutions = false;
                    
                    institutions.forEach(institution => {
                        // Filter courses by recommended career
                        const relevantCourses = institution.courses.filter(course => 
                            course.career === recommendedCareer
                        );
                        
                        if (relevantCourses.length > 0) {
                            hasRelevantInstitutions = true;
                            const institutionDiv = document.createElement('div');
                            institutionDiv.classList.add('institution-card');
                            
                            let coursesHTML = '';
                            relevantCourses.forEach(course => {
                                coursesHTML += `<li>${course.name} <span class="relevant-tag">Relevante para ${recommendedCareer}</span></li>`;
                            });
                            
                            institutionDiv.innerHTML = `
                                <h3 class="institution-name">${institution.name}</h3>
                                <p style="color: #666; margin-bottom: 15px;">${institution.address}</p>
                                <div class="courses-section">
                                    <h4>Cursos disponíveis para ${recommendedCareer}:</h4>
                                    <ul class="courses-list">
                                        ${coursesHTML}
                                    </ul>
                                </div>
                                <a href="${institution.link}" target="_blank" class="enroll-btn">Visitar Site da Instituição</a>
                            `;
                            institutionsList.appendChild(institutionDiv);
                        }
                    });
                    
                    if (!hasRelevantInstitutions) {
                        // Show all courses if no specific ones found
                        institutions.forEach(institution => {
                            const institutionDiv = document.createElement('div');
                            institutionDiv.classList.add('institution-card');
                            
                            let coursesHTML = '';
                            institution.courses.forEach(course => {
                                coursesHTML += `<li>${course.name}</li>`;
                            });
                            
                            institutionDiv.innerHTML = `
                                <h3 class="institution-name">${institution.name}</h3>
                                <p style="color: #666; margin-bottom: 15px;">${institution.address}</p>
                                <div class="courses-section">
                                    <h4>Cursos disponíveis:</h4>
                                    <ul class="courses-list">
                                        ${coursesHTML}
                                    </ul>
                                </div>
                                <a href="${institution.link}" target="_blank" class="enroll-btn">Visitar Site da Instituição</a>
                            `;
                            institutionsList.appendChild(institutionDiv);
                        });
                    }
                } catch (error) {
                    errorMessage.textContent = 'Erro ao atualizar instituições: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Update institutions error:', error);
                }
            }

            // Toggle favorite for current career
            function toggleFavorite() {
                try {
                    if (favoritedCareers.includes(recommendedCareer)) {
                        favoritedCareers = favoritedCareers.filter(c => c !== recommendedCareer);
                        favoriteBtn.classList.remove('favorited');
                        favoriteBtn.textContent = '☆ Favoritar';
                    } else {
                        favoritedCareers.push(recommendedCareer);
                        favoriteBtn.classList.add('favorited');
                        favoriteBtn.textContent = '★ Favorito';
                    }
                } catch (error) {
                    errorMessage.textContent = 'Erro ao favoritar carreira: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Favorite error:', error);
                }
            }

            // Reset quiz function
            function resetQuiz() {
                try {
                    // Reset all variables
                    currentStep = 0;
                    answers = {};
                    recommendedCareer = null;
                    favoritedCareers = [];
                    
                    // Hide recommendation screen and show question screen
                    recommendationScreen.style.display = 'none';
                    questionScreen.style.display = 'block';
                    
                    // Show first question
                    showQuestion(0);
                } catch (error) {
                    errorMessage.textContent = 'Erro ao reiniciar o teste: ' + error.message;
                    errorMessage.style.display = 'block';
                    console.error('Reset quiz error:', error);
                }
            }

            // Save as PDF (mock function)
            function saveAsPDF() {
                alert('Seu resultado foi gerado! Em um aplicativo real, isso criaria um PDF com suas recomendações.');
            }

            // Initialize the application
            init();
        }
    </script>
</body>
</html>